# -*- coding: utf-8 -*-
"""Titanic_Dataset

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1VKNjsvXV8mhjHARUkJNTVfaSZMBKz9vM
"""

import seaborn as sns
import pandas as pd
import numpy as np
import warnings
warnings.filterwarnings('ignore')

!pip install seaborn
import seaborn as sns

df = sns.load_dataset('titanic')

df.head()

df=df[["survived","pclass","sex","age","fare","embarked"]]
df.head()

df.isna().sum()

df["age"].fillna(df["age"].median(),inplace=True)
df["embarked"].fillna(df["embarked"].mode()[0],inplace=True)

df.isna().sum()

from sklearn.preprocessing import LabelEncoder

# Create a LabelEncoder object
encoder = LabelEncoder()

# Apply Label Encoding to 'sex' column
df['sex'] = encoder.fit_transform(df['sex'])

# Apply Label Encoding to 'embarked' column
df['embarked'] = encoder.fit_transform(df['embarked'])

df.head()

X = df.drop("survived",axis=1)
y=df["survived"]
X.head(),y.head()

from sklearn.model_selection import train_test_split
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)

from sklearn.tree import DecisionTreeClassifier
classifier=DecisionTreeClassifier(
    criterion="gini",max_depth=4,random_state=42)
classifier.fit(X_train,y_train)

y_pred=classifier.predict(X_test)

from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score, classification_report

# Train the model
model = LogisticRegression()
model.fit(X_train, y_train)

# Predictions
y_pred = model.predict(X_test)
print("Predictions:", y_pred)

# Accuracy
accuracy = accuracy_score(y_test, y_pred)
print(f"Accuracy: {accuracy:.2f}")

# Classification Report
print("\nClassification Report:\n", classification_report(y_test, y_pred))

from sklearn.metrics import confusion_matrix

cm = confusion_matrix(y_test, y_pred)
print("Confusion Matrix:\n", cm)

from sklearn.metrics import ConfusionMatrixDisplay
import matplotlib.pyplot as plt

ConfusionMatrixDisplay.from_predictions(
    y_test,
    y_pred,
    cmap="Blues",
    values_format="d"
)

plt.title("Confusion Matrix")
plt.show()

from sklearn.tree import plot_tree
import matplotlib.pyplot as plt

plt.figure(figsize=(18, 10))
plot_tree(classifier, filled=True, feature_names=X.columns, class_names=['Not Survived',"Survived"],rounded=True)
plt.show()

new_passenger=pd.DataFrame([[3,1,25,7,2]],columns=X.columns)
prediction=model.predict(new_passenger)
prediction

if prediction[0]==1:
  print("Likely to survive")
else:
  print("Likely to not survive")

